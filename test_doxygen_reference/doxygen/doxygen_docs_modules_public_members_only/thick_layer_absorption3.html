<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: Details of the &lt;tt&gt;thick_layer_absorption&lt;/tt&gt; function</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('thick_layer_absorption3.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Details of the <code>thick_layer_absorption</code> function </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md__github_workspace_src_module_library_supplementary_documentation_thick_layer_absorption"></a></p>
<p >This document explains something of the origins of and rationale for the formula used in the <code>thick_layer_absorption</code> function found in the C++ source code file <code><a class="el" href="sun_m_l_8cpp.html">src/module_library/sunML.cpp</a></code>.</p>
<p >Suppose light of intensity \(I_0\) (representing a flux density of photons or energy, expressed in units of photons per area per time or energy per area per time) is incident on the surface of an infinitely thick piece of a material that reflects, absorbs, and transmits light with no lateral variations.(<a class="el" href="thick_layer_absorption3.html#fn">1</a>) As the light passes through the material, its intensity will gradually diminish until it eventually reaches zero. We can express this mathematically via a one-dimensional expression</p>
<p class="formulaDsp">
\[
        I(x) = I_0 \cdot f(x),
\]
</p>
<p >where \(x\) is a coordinate that represents the amount of material the light has passed through, and \(f(x)\) is the fraction of the original light received by the material at \(x\). Note that if the material does not have uniform density, \(x\) is not a spatial coordinate, but instead will have a non-linear dependence on distance. Although we do not know the particular form of \(f(x)\), we can safely assume that \(f\) is monotonic, that \(f(0) =
1\) (so the incident light at the material's surface is \(I_0\)), and that \(f(x)\) approaches 0 as \(x\) approaches infinity (so the light intensity is fully diminished deep within the material).</p>
<p >Now consider two points \(x_0\) and \(x_0 + \Delta x\) within the material, separated by an amount of material \(\Delta x\). The decrease in light intensity per unit material between these two points, \(\Delta I/\Delta x\), can be expressed as \(\Delta I/\Delta x = (I(x_0 + \Delta x) - I(x_0)) / \Delta
x\). Rewriting this using \(f(x)\), we have \(\Delta I/\Delta x = I_0 \cdot
(f(x_0 + \Delta x) - f(x_0)) / \Delta x\). If we assume that the decrease in intensity is due to the absorption and reflection of light by \(\Delta x\), we can also write \(\Delta
I/\Delta x = - I(x) \cdot (A + R)\), where \(A\) and \(R\) are the fractions of incident light absorbed and reflected by a thin layer of the material. Thus, we can equate the two expressions for \(\Delta I/\Delta x\) to find that \(I_0 \cdot (f(x_0 + \Delta x) - f(x_0)) / \Delta x = - I_0 \cdot
f(x) \cdot (A + R)\) or, equivalently, \((f(x_0 + \Delta x) - f(x_0)) / \Delta
x = - f(x) \cdot (A + R)\). As \(\Delta x\) approaches 0, we can recognize the left-hand side of this equation as the derivative of \(f(x)\) with respect to \(x\): \(f&#39;(x) = - f(x) \cdot (A + R)\). Rearranging, we can express \(f(x)\) in terms of its derivative and the material's optical properties: \(f(x) = -f&#39;(x) / (A + R)\). Noting that all light received by a thin layer of the material must be reflected, absorbed, or transmitted, we can rewrite this equation using the fraction of transmitted light \(T\) using \(A + R + T =
1\) as follows:</p>
<p class="formulaDsp">
\[
        f(x) = -f&#39;(x) / (1 - T)\qquad\text{(1)}
\]
</p>
<p >This simple model for calculating light intensities within a material was first applied in the context of plant biology by Monsi &amp; Saeki (1953), where it used to calculate light levels within a plant canopy. This paper is difficult to find and was written in German, but parts of it have been reproduced in English and are easier to access (Saeki 1960, Saeiki 1963, Hirose 2004). Saeki (1960) notes the following about this equation:</p>
<blockquote class="doxtable">
<p >&zwj;It must be noted that in these equations \(m\) includes not only the fraction resulting from light transmitted through the leaf blades but also the fraction reflected downward from inclined leaves. This \(m\) is not constant but increases with the depth of foliage, because light of particular wavelengths is more liable to be reflected and transmitted, and increases in proportion at deeper positions. </p>
</blockquote>
<p>(In the original notation, \(m\) was used in place of the \(T\) we use here.) Thus, \(T\), \(R\), and \(A\) are not exactly the same as the corresponding optical properties of an isolated layer of the material (such as a leaf).</p>
<p >If we consider light from a sufficiently narrow wavelength band, then it may be reasonable to suppose that \(T\), \(R\), and \(A\) are constant throughout the material. In this case, it is possible to estimate the total amount of light absorbed by the material. To do this, we first calculate the absorbed light at depth \(x\) ( \(I_\text{abs}(x)\)) using \(I_\text{abs}(x) = I(x) \cdot A\). Substituting in Equation (1), we have \(I_\text{abs}(x) = - I_0 \cdot f&#39;(x) \cdot (1 - R - T) / (1 - T)\). Now we can integrate this across the entire range of \(x\) (0 to infinity) to find the total amount of light absorbed by the material ( \(I_\text{abs (total)}\)): \(I_\text{abs (total)} = I_0 \cdot (1 - R - T) / (1 - T) \cdot (f(0) - f(\infty))\). By assumption, \(f(0) = 1\) and \(f(\infty) = 0\), so this evaluates to</p>
<p class="formulaDsp">
\[
        I_\text{abs (total)} = I_0 \cdot (1 - R - T) / (1 - T)\qquad\text{(2)}
\]
</p>
<p >Note that Equation (2) agrees with intuition in two extreme situations. First, if the material does not reflect any light ( \(R = 0\)), then Equation (2) reduces to \(I_\text{abs (total)} = I_0\). This makes sense because even if thin layers of the material transmit light, there is no way for any light to avoid being absorbed by an infinitely thick layer if there is no reflection. The other situation is where the material does not transmit any light ( \(T = 0\)). In this case, Equation (2) reduces to \(I_\text{abs (total)} = I_0 \cdot (1 - R)\). This makes sense because the optical properties of a material with no transmission would be determined only by its surface; the surface would have the same optical properties as any thin layer, reflecting a fraction \(R\) of the light and absorbing the rest.</p>
<p >Although Equation (1) was originally developed for plant canopies, it does not rely on any specific properties of canopies, and can in principle apply to any material. (In fact, we have written this derivation in a material-agnostic way to emphasize this.) Thus, Equation (2) can also apply to a wide variety of materials. The absorption and reflection of light by soil is another situation where Equation (2) may be useful, as the assumption of a thick layer that does not transmit any light through it is certainly justified in that scenario.</p>
<p >Because it assumes a thick layer of a homogeneous light-absorbing material, Equation (2) is not appropriate for use in a layered canopy model or one that makes distinctions between different leaf classes (such as sunlit and shaded). It is best used for situations like estimating whole-canopy transpiration or soil evaporation, where it is useful to know the total solar energy absorbed by a thick layer of leaves or soil. Care must be taken even in this case, however, since this equation would still not be appropriate for the small canopies of young plants, which certainly transmit a significant fraction of the incident light.</p>
<p >Caveat from EL: Although Equation (1) can be found in Monsi &amp; Saeki (1953), Saeki (1960), and Saeki (1963), Equation (2) is not included in those references. So, although this derivation makes sense to me, there is still a chance that it might not be correct. Equation (2) can be found in Steve H's thesis, the WIMOVAC code, and the BioCro code. In these places, it is variously attributed to Thornley &amp; Johnson (1990), Monteith (1973), and Monteith and Unsworth (1990). Unfortunately, these textbooks are not available in electronic form, and I cannot access them at the moment. Newer versions of Monteith &amp; Unsworth (1990) are available electronically, but do not seem to include Equation (2). I have attempted to find an explanation for Equation (2) elsewhere, but have not been successful so far. Thonrley (2002) discusses Equation (1), but ultimately just references the (inaccessible) textbook.</p>
<p >References:</p>
<ul>
<li>Monsi, M. &amp; Saeki, T. Über den Lichtfaktor in den Pflanzengesellschaften und seine Bedeutung für die Stoffproduktion. Japanese Journal of Botany 14, 2252 (1953).</li>
<li>Saeki, T. Interrelationships between Leaf Amount, Light Distribution and Total Photosynthesis in a Plant Community. Shokubutsugaku Zasshi 73, 55–63 (1960).</li>
<li>Saeki, T. Light Relations In Plant Communities. in Environmental Control of Plant Growth (ed. Evans, L. T.) 79–94 (Academic Press, 1963).</li>
<li>Hirose, T. Development of the Monsi–Saeki Theory on Canopy Structure and Function. Annals of Botany 95, 483–494 (2004).</li>
<li>Thornley, J. H. M. &amp; Johnson, I. R. Plant and crop modelling: A mathematical approach to plant and crop physiology (2000).</li>
<li>Monteith, J. L. Principles of Environmental Physics (1973).</li>
<li>Monteith, J. L. &amp; Unsworth, M. H. Principles of Environmental Physics (1990).</li>
<li>Thornley, J. H. M. Instantaneous Canopy Photosynthesis: Analytical Expressions for Sun and Shade Leaves Based on Exponential Light Decay Down the Canopy and an Acclimated Non-rectangular Hyperbola for Leaf Photosynthesis. Ann Bot 89, 451–458 (2002).</li>
</ul>
<p ><a class="anchor" id="fn"></a>1. Does "no lateral variation" mean that the rate of reflection, transmission, and absorption is constant along any plane perpendicular to the direction of the light? Or any along any plane parallel to the surface of the canopy? Or neither of these? </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Feb 20 2023 00:37:20 for The BioCro C++ Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
