<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BioCro">
<title>Details of the `thick_layer_absorption` function • BioCro</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Details of the `thick_layer_absorption` function">
<meta property="og:description" content="BioCro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BioCro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../about_pkgdown_documentation.html">About</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_practical_guide_to_biocro.pdf">A Practical Guide to BioCro (PDF)</a>
    <a class="dropdown-item" href="../articles/a_practical_guide_to_biocro.R">    R code</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/quantitative_model_comparison.pdf">Quantitative Comparison Between Two Photosynthesis Models (PDF)</a>
    <a class="dropdown-item" href="../articles/quantitative_model_comparison.R">    R code</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/BioCro-II_Paper--Section-1.1-example.html">BioCro II Paper: Section 1.1 Example (HTML)</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/an_introduction_to_biocro.pdf">An Introduction to BioCro for Those Who Want to Add Models (PDF)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../bookdown/index.html">Developer's Manual</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-c-library">C++ Library</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-c-library">
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_complete/index.html">Complete Doxygen Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_framework/index.html">Framework Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_modules/index.html">BioCro Module Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_modules_public_members_only/index.html">BioCro Module Documentation (public members only)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ebimodeling/biocro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Details of the `thick_layer_absorption` function</h1>
                        <h4 data-toc-skip class="author">Edward B. Lochocki</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ebimodeling/biocro/blob/HEAD/vignettes/thick_layer_absorption.Rmd" class="external-link"><code>vignettes/thick_layer_absorption.Rmd</code></a></small>
      <div class="d-none name"><code>thick_layer_absorption.Rmd</code></div>
    </div>

    
    
<p>This vignette explains something of the origins of and rationale for the formula
used in the <code>thick_layer_absorption</code> function found in the C++ source code file
<code>src/module_library/sunML.cpp</code>.</p>
<p>Suppose light of intensity <span class="math inline">\(I_0\)</span> (representing a flux density of photons or
energy, expressed in units of photons per area per time or energy per area per
time) is incident on the surface of an infinitely thick piece of a material that
reflects, absorbs, and transmits light with no lateral
variations.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Does “no lateral variations” mean that the rates of
reflection, transmission, and absorption are constant along any plane
perpendicular to the direction of the light? Or along any plane parallel to the
surface of the canopy? Or neither of these?&lt;/p&gt;"><sup>1</sup></a> As the light passes through the material, its
intensity will gradually diminish until it eventually reaches zero. We can
express this mathematically via a one-dimensional expression</p>
<p><span class="math display">\[\begin{equation}
        I(x) = I_0 \cdot f(x),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(x\)</span> is a coordinate that represents the amount of material the light has
passed through, and <span class="math inline">\(f(x)\)</span> is the fraction of the original light received by the
material at <span class="math inline">\(x\)</span>. Note that if the material does not have uniform density, <span class="math inline">\(x\)</span> is
not a spatial coordinate, but instead will have a non-linear dependence on
distance.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;I was trying to figure out the reason for &lt;em&gt;not&lt;/em&gt;
making &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; a “spatial” variable, that is, a variable representing the depth, in
some unit of length, into the canopy. What I came up with is this: We want to
allow for the case where at some depth, the amount of material is zero so that
there is no reflectance or absorption at that level. But this causes problems
once we reach the equation that expresses &lt;span class=&quot;math inline&quot;&gt;\(f(x)\)&lt;/span&gt; as &lt;span class=&quot;math inline&quot;&gt;\(-f'(x) / (A + R)\)&lt;/span&gt; because
the latter then reduces to &lt;span class=&quot;math inline&quot;&gt;\(0/0\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;More generally, when we turn to computing total absorption, we want to make
the supposition that &lt;span class=&quot;math inline&quot;&gt;\(T\)&lt;/span&gt;, &lt;span class=&quot;math inline&quot;&gt;\(R\)&lt;/span&gt;, and &lt;span class=&quot;math inline&quot;&gt;\(A\)&lt;/span&gt; are constant throughout the material
plausible, at least in the case of light from a sufficiently narrow wavelength
band. It should be noted, though (somewhat disconcertingly), that the “thin
layers of material” invoked multiple times above, might actually be very thick
in spacial terms if there are significant layers of zero or very low density.&lt;/p&gt;"><sup>2</sup></a> Although we do not know the particular
form of <span class="math inline">\(f(x)\)</span>, we can safely assume that <span class="math inline">\(f\)</span> is monotonic, that <span class="math inline">\(f(0) = 1\)</span> (so
the incident light at the material’s surface is <span class="math inline">\(I_0\)</span>), and that <span class="math inline">\(f(x)\)</span>
approaches 0 as <span class="math inline">\(x\)</span> approaches infinity (so the light intensity is fully
diminished deep within the material).</p>
<p>Now consider two points <span class="math inline">\(x_0\)</span><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Using &lt;span class=&quot;math inline&quot;&gt;\(x_0\)&lt;/span&gt; (or &lt;code&gt;x_0&lt;/code&gt;) as the notation for an arbitrary point
within the material seems at least slightly problematic when at the same time
you use &lt;span class=&quot;math inline&quot;&gt;\(I_0\)&lt;/span&gt; (&lt;code&gt;I_0&lt;/code&gt;) as the notation for the light intensity at depth zero.
Simply using &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; might be a better choice, and doing so might also mitigate the
problems I point out with some of the equations below. (This all assumes I am
understanding your intended meaning correctly.)&lt;/p&gt;
&lt;p&gt;Alternatively, if you want to more clearly distinguish the variable &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; and
a particular value of &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt;, consider using &lt;span class=&quot;math inline&quot;&gt;\(x'\)&lt;/span&gt; or &lt;span class=&quot;math inline&quot;&gt;\(\hat{x}\)&lt;/span&gt; instead of &lt;span class=&quot;math inline&quot;&gt;\(x_0\)&lt;/span&gt;.&lt;/p&gt;"><sup>3</sup></a> and <span class="math inline">\(x_0 + \Delta x\)</span> within the
material, separated by an amount of material <span class="math inline">\(\Delta x\)</span>. The decrease in light
intensity per unit material between these two points, <span class="math inline">\(\Delta I/\Delta x\)</span><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;I use &lt;span class="math inline"&gt;\(\Delta I/\Delta x\)&lt;/span&gt; to denote what you call &lt;code&gt;delta_I&lt;/code&gt;,
since using &lt;span class="math inline"&gt;\(\Delta I\)&lt;/span&gt; would incorrectly suggest that we are referring simply to
the change in &lt;span class="math inline"&gt;\(I\)&lt;/span&gt; rather than to the change in &lt;span class="math inline"&gt;\(I\)&lt;/span&gt; relative to the change in
&lt;span class="math inline"&gt;\(x\)&lt;/span&gt;.&lt;/p&gt;'><sup>4</sup></a>, can be expressed as<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;It might be clearer to say “the &lt;em&gt;change&lt;/em&gt; in light
intensity” rather than “the &lt;em&gt;decrease&lt;/em&gt; in light intensity”, since one might
argue that a &lt;em&gt;negative&lt;/em&gt; value for a &lt;em&gt;decrease&lt;/em&gt; (as we get in both sides of this
equation) corresponds to an &lt;em&gt;increase&lt;/em&gt;. In other words, the amount of decrease
in light intensity (as we go deeper into the canopy) is positive.&lt;/p&gt;"><sup>5</sup></a>
<span class="math display">\[\begin{equation}
        \Delta I/\Delta x = (I(x_0 + \Delta x) - I(x_0)) / \Delta x.
\end{equation}\]</span>
Rewriting this using <span class="math inline">\(f(x)\)</span>, we have
<span class="math display">\[\begin{equation}
        \Delta I/\Delta x = I_0 \cdot (f(x_0 + \Delta x) - f(x_0)) / \Delta x.
\end{equation}\]</span>
If we assume that the decrease in intensity is due to the absorption and
reflection of light as we pass from point <span class="math inline">\(x_0\)</span> to point <span class="math inline">\(x_0 + \Delta x\)</span>,<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;I reworded this to say what I think (what I hope) you mean.&lt;/p&gt;"><sup>6</sup></a> we can also write
<span class="math display">\[\begin{equation}
        \Delta I/\Delta x = - I(x) \cdot (A + R),
\end{equation}\]</span>
where <span class="math inline">\(A\)</span> and <span class="math inline">\(R\)</span> are the fractions of incident light absorbed
and reflected by a thin layer of the material.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Something seems wrong here. You are equating an expression that
depends upon &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; (the right-hand side) with one that doesn’t (the left-hand
side). Similarly for the two equations immediately following.&lt;/p&gt;
&lt;p&gt;Perhaps you mean &lt;span class=&quot;math inline&quot;&gt;\(x_0\)&lt;/span&gt; rather than &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; (but see the previous footnote
regarding the notation for &lt;span class=&quot;math inline&quot;&gt;\(x_0\)&lt;/span&gt;), since I think you are trying to express the
decrease in light intensity per unit material in the vicinity of the two points
&lt;span class=&quot;math inline&quot;&gt;\(x_0\)&lt;/span&gt; and &lt;span class=&quot;math inline&quot;&gt;\(x_0 + \Delta x\)&lt;/span&gt;. If so, the equation is only approximate, since we
haven’t yet taken the limit as &lt;span class=&quot;math inline&quot;&gt;\(\Delta x \to 0\)&lt;/span&gt;, and &lt;span class=&quot;math inline&quot;&gt;\(I(x)\)&lt;/span&gt; is changing as we
pass from &lt;span class=&quot;math inline&quot;&gt;\(x = x_0\)&lt;/span&gt; to &lt;span class=&quot;math inline&quot;&gt;\(x = x_0 + \Delta x\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Or perhaps your were thinking of this equation, in which introducing &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; as
a bound variable is perfectly fine: &lt;span class=&quot;math inline&quot;&gt;\(\Delta I = -\int_{x_0}^{x_0+\Delta x}I(x)\cdot(A(x) + R(x))\,dx\)&lt;/span&gt;. Assuming A and R are constant (as we do later
on) and using the mean value theorem, we can rewrite the right-hand side as
&lt;span class=&quot;math inline&quot;&gt;\(\Delta x\cdot I(x')\cdot(A + R)\)&lt;/span&gt; for some &lt;span class=&quot;math inline&quot;&gt;\(x'\)&lt;/span&gt; in the interval &lt;span class=&quot;math inline&quot;&gt;\((x_0, x_0 + \Delta x)\)&lt;/span&gt; so that &lt;span class=&quot;math inline&quot;&gt;\(\Delta I/\Delta x = I(x')\cdot(A + R)\)&lt;/span&gt; for some &lt;span class=&quot;math inline&quot;&gt;\(x'\)&lt;/span&gt; near
&lt;span class=&quot;math inline&quot;&gt;\(x_0\)&lt;/span&gt;.&lt;/p&gt;"><sup>7</sup></a> Thus, we can equate the two
expressions for <span class="math inline">\(\Delta I/\Delta x\)</span> to find that
<span class="math display">\[\begin{equation}
        I_0 \cdot (f(x_0 + \Delta x) - f(x_0)) / \Delta x = - I_0 \cdot f(x) \cdot (A + R)
\end{equation}\]</span>
or, equivalently,
<span class="math display">\[\begin{equation}
        (f(x_0 + \Delta x) - f(x_0)) / \Delta x = - f(x) \cdot (A + R).
\end{equation}\]</span>
As <span class="math inline">\(\Delta x\)</span> approaches 0, we can recognize the left-hand side of this equation
as the derivative of <span class="math inline">\(f(x)\)</span> with respect to <span class="math inline">\(x\)</span>:
<span class="math display">\[\begin{equation}
        f'(x) = - f(x) \cdot (A + R).
\end{equation}\]</span>
Rearranging, we can express <span class="math inline">\(f(x)\)</span> in terms of its derivative and the material’s
optical properties:
<span class="math display">\[\begin{equation}
        f(x) = -f'(x) / (A + R).
\end{equation}\]</span>
Noting that all light received by a thin layer of the material must be
reflected, absorbed, or transmitted, we can use <span class="math inline">\(A + R + T = 1\)</span> to rewrite this
equation in terms of the fraction of transmitted light <span class="math inline">\(T\)</span>:
<span class="math display">\[\begin{equation}
        f(x) = -f'(x) / (1 - T)\qquad\text{(1)}
\end{equation}\]</span></p>
<p>This simple model for calculating light intensities within a material was first
applied in the context of plant biology by Monsi &amp; Saeki (1953), where it is
used to calculate light levels within a plant canopy. This paper is difficult to
find and was written in German, but parts of it have been reproduced in English
and are easier to access (Saeki 1960, Saeki 1963, Hirose 2004). Saeki (1960)
notes the following about this equation:</p>
<blockquote>
<p>It must be noted that in these equations <span class="math inline">\(m\)</span> includes not only
the fraction resulting from light transmitted through the leaf
blades but also the fraction reflected downward from inclined
leaves. This <span class="math inline">\(m\)</span> is not constant but increases with the depth of
foliage, because light of particular wavelengths is more liable to
be reflected and transmitted, and increases in proportion at deeper
positions.</p>
</blockquote>
<p>(In the original notation, <span class="math inline">\(m\)</span> was used in place of the <span class="math inline">\(T\)</span> we
use here.) Thus, <span class="math inline">\(T\)</span>, <span class="math inline">\(R\)</span>, and <span class="math inline">\(A\)</span> are not exactly the
same as the corresponding optical properties of an isolated layer of
the material (such as a leaf).</p>
<p>If we consider light from a sufficiently narrow wavelength band, then it may be
reasonable to suppose that <span class="math inline">\(T\)</span>, <span class="math inline">\(R\)</span>, and <span class="math inline">\(A\)</span> are constant throughout the
material.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;It seems to me you have already been assuming this implicitely
above, since you write &lt;span class="math inline"&gt;\(T\)&lt;/span&gt;, &lt;span class="math inline"&gt;\(R\)&lt;/span&gt;, and &lt;span class="math inline"&gt;\(A\)&lt;/span&gt; rather than, say, &lt;span class="math inline"&gt;\(T(x)\)&lt;/span&gt;, &lt;span class="math inline"&gt;\(R(x)\)&lt;/span&gt;, and
&lt;span class="math inline"&gt;\(A(x)\)&lt;/span&gt;.&lt;/p&gt;'><sup>8</sup></a> In this case, it is possible to estimate the total amount
of light absorbed by the material. To do this, we first calculate the absorbed
light at depth <span class="math inline">\(x\)</span> per unit material<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;I added “per unit material” here, because clearly the amount
of light absorbed at any particular depth is infinitesimal. And I emphasize
this in the notation by using &lt;span class="math inline"&gt;\(D_x I_\text{abs}(x)\)&lt;/span&gt; in place of
&lt;span class="math inline"&gt;\(I_\text{abs}(x)\)&lt;/span&gt; (your &lt;code&gt;I_abs(x)&lt;/code&gt;). I used the derivative notation &lt;span class="math inline"&gt;\(D_x I_\text{abs}(x)\)&lt;/span&gt; rather than &lt;span class="math inline"&gt;\(d I_\text{abs}(x)/d x\)&lt;/span&gt; because it seemed clearer
and less awkward.&lt;/p&gt;'><sup>9</sup></a>, <span class="math inline">\(D_x I_\text{abs}(x)\)</span>,
using <span class="math inline">\(D_x I_\text{abs}(x) = I(x) \cdot A\)</span>. Substituting in Equation
(1)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;It seems to me we are, rather, substituting into the equation
&lt;span class="math inline"&gt;\(D_x I_\text{abs}(x) = I(x) \cdot A\)&lt;/span&gt; (here I’ve used my notation), &lt;em&gt;using&lt;/em&gt;
Equation 1, as well as &lt;span class="math inline"&gt;\(I(x) = I_0 \cdot f(x)\)&lt;/span&gt; and &lt;span class="math inline"&gt;\(A = 1 - R - T\)&lt;/span&gt;, to effect
the substitution.&lt;/p&gt;'><sup>10</sup></a>, we have</p>
<p><span class="math display">\[\begin{equation}
        D_x I_\text{abs}(x) = - I_0 \cdot f'(x) \cdot (1 - R - T) / (1 - T).
\end{equation}\]</span>
Now we can integrate this across the entire range of <span class="math inline">\(x\)</span> (0 to infinity) to find
the total amount of light absorbed by the material (<span class="math inline">\(I_\text{abs (total)}\)</span>):
<span class="math display">\[\begin{equation}
        I_\text{abs (total)} = I_0 \cdot (1 - R - T) / (1 - T) \cdot (f(0) - f(\infty)).
\end{equation}\]</span>
By assumption, <span class="math inline">\(f(0) = 1\)</span> and <span class="math inline">\(f(\infty) = 0\)</span>, so this evaluates to
<span class="math display">\[\begin{equation}
        I_\text{abs (total)} = I_0 \cdot (1 - R - T) / (1 - T)\qquad\text{(2)}
\end{equation}\]</span></p>
<p>Note that Equation (2) agrees with intuition in two extreme situations.
First, if the material does not reflect any light (<span class="math inline">\(R = 0\)</span>), then Equation
(2) reduces to <span class="math inline">\(I_\text{abs (total)} = I_0\)</span>. This makes sense because even if thin
layers of the material transmit light, there is no way for any light to
avoid being absorbed by an infinitely thick layer if there is no reflection.
The other situation is where the material does not transmit any light
(<span class="math inline">\(T = 0\)</span>). In this case, Equation (2) reduces to
<span class="math inline">\(I_\text{abs (total)} = I_0 \cdot (1 - R)\)</span>. This makes sense because the optical properties
of a material with no transmission would be determined only by its surface;
the surface would have the same optical properties as any thin layer,
reflecting a fraction <span class="math inline">\(R\)</span> of the light and absorbing the rest.</p>
<p>Although Equation (1) was originally developed for plant canopies, it does not
rely on any specific properties of canopies and can in principle apply to any
material. (In fact, we have written this derivation in a material-agnostic way
to emphasize this.) Thus, Equation (2) can also apply to a wide variety of
materials. The absorption and reflection of light by soil is another situation
where Equation (2) may be useful, as the assumption of a thick layer that does
not transmit any light through it is certainly justified in that scenario.</p>
<p>Because it assumes a thick layer of a homogeneous light-absorbing material,
Equation (2) is not appropriate for use in a layered canopy model or one that
makes distinctions between different leaf classes (such as sunlit and
shaded). It is best used for situations such as estimating whole-canopy
transpiration or soil evaporation, where it is useful to know the total solar
energy absorbed by a thick layer of leaves or soil. Care must be taken even in
this case, however, since this equation would still not be appropriate for the
small canopies of young plants, which certainly transmit a significant fraction
of the incident light.</p>
<p><strong>Caveat from the author:</strong><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If you’re going to bother saying “Caveat from EL” rather
than just “Caveat”, it seems to me you may as well fully identify yourself as
the author. So I added author metadata. (There is an &lt;code&gt;@author&lt;/code&gt; special command
in Doxygen as well, by the way.)&lt;/p&gt;"><sup>11</sup></a> Although Equation (1) can be
found in Monsi &amp; Saeki (1953), Saeki (1960), and Saeki (1963), Equation (2) is
not included in those references. So, although this derivation makes sense to
me, there is still a chance that it might not be correct. Equation (2) can be
found in Steve H’s thesis<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;You probably should include a reference for this. At the very
least, write out Steve H.’s name in full. I realize you may think it
appropriate to be less formal here than you would be in writing a full-fledged
vignette, but I still think you should operate under the assumption that not all
readers will know who Steve H. is.&lt;/p&gt;"><sup>12</sup></a>, the WIMOVAC code, and the BioCro code. In
these places, it is variously attributed to Thornley &amp; Johnson
(1990)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;I take this to be an earlier edition of Thornley &amp;amp; Johnson
(2000) (which is not itself referred to anywhere in this document). If you want
to be clear, you should make a separate reference for it or replace the 2000
reference.&lt;/p&gt;"><sup>13</sup></a>, Monteith (1973), and Monteith and Unsworth
(1990). Unfortunately, these textbooks are not available in electronic form, and
I cannot access them at the moment. Newer versions of Monteith &amp; Unsworth (1990)
are available electronically, but they do not seem to include Equation (2). I
have attempted to find an explanation for Equation (2) elsewhere but have not
been successful so far. Thornley (2002) discusses Equation (1), but he
ultimately just references the (inaccessible) textbook.</p>
<p>References:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;In case we don’t want to make a vignette out of this,
Doxygen has a &lt;span class="citation"&gt;@cite&lt;/span&gt; command for bibliographic references, which then requires
including a &lt;code&gt;.bib&lt;/code&gt; file. But I’m not sure we want to go there.&lt;/p&gt;'><sup>14</sup></a></p>
<ul>
<li><p>Monsi, M. &amp; Saeki, T. Über den Lichtfaktor in den Pflanzengesellschaften
und seine Bedeutung für die Stoffproduktion. Japanese Journal of Botany
14, 2252 (1953).</p></li>
<li><p>Saeki, T. Interrelationships between Leaf Amount, Light Distribution and
Total Photosynthesis in a Plant Community. Shokubutsugaku Zasshi 73, 55–63
(1960).</p></li>
<li><p>Saeki, T. Light Relations In Plant Communities. in Environmental Control
of Plant Growth (ed. Evans, L. T.) 79–94 (Academic Press, 1963).</p></li>
<li><p>Hirose, T. Development of the Monsi–Saeki Theory on Canopy Structure and
Function. Annals of Botany 95, 483–494 (2004).</p></li>
<li><p>Thornley, J. H. M. &amp; Johnson, I. R. Plant and crop modelling: A
mathematical approach to plant and crop physiology (2000).</p></li>
<li><p>Monteith, J. L. Principles of Environmental Physics (1973).</p></li>
<li><p>Monteith, J. L. &amp; Unsworth, M. H. Principles of Environmental Physics
(1990).</p></li>
<li><p>Thornley, J. H. M. Instantaneous Canopy Photosynthesis: Analytical
Expressions for Sun and Shade Leaves Based on Exponential Light Decay Down
the Canopy and an Acclimated Non-rectangular Hyperbola for Leaf
Photosynthesis. Ann Bot 89, 451–458 (2002).</p></li>
</ul>
<!-- footnotes -->
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Justin M. McGrath, Edward B. Lochocki, Scott Rohde, Deepak Jaiswal, Megan L. Matthews, Fernando E. Miguez, Stephen P. Long.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
